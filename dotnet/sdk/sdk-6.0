FROM rockylinux/rockylinux:9

ARG BUILDTIME_MIRROR=
ARG PWSH_URL=https://github.com/PowerShell/PowerShell/releases/download/v7.3.4/powershell-7.3.4-1.rh.x86_64.rpm

COPY pre-ex.sh pre-ex.sh
COPY post-ex.sh post-ex.sh

RUN ./pre-ex.sh \
    && dnf install -y gettext dotnet-sdk-6.0 wget \
    && wget -O pwsh.rpm ${PWSH_URL} \
    && dnf install ./pwsh.rpm -y \
    && ./post-ex.sh \
    && rm pre-ex.sh post-ex.sh pwsh.rpm
